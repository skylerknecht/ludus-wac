# --- Prereqs -------------------------------------------------

- name: Ensure temp directory exists
  ansible.windows.win_file:
    path: C:\Temp
    state: directory

- name: Download Visual C++ Redistributable (x64)
  ansible.windows.win_get_url:
    url: https://aka.ms/vs/17/release/vc_redist.x64.exe
    dest: C:\Temp\vc_redist.x64.exe

- name: Install Visual C++ Redistributable (silent)
  ansible.windows.win_shell: |
    Start-Process -FilePath C:\Temp\vc_redist.x64.exe -ArgumentList "/install /quiet /norestart" -Wait
  args:
    creates: C:\Windows\System32\vcruntime140.dll